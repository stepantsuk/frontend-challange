# Beacon API

## Главное
Beacon API — это специализированный инструмент для гарантированной отправки аналитических данных при разгрузке страницы. Ключевые особенности: не блокирует переход пользователя, работает асинхронно, не предоставляет доступ к ответу сервера. Основное применение — логирование событий завершения сессии, отправка метрик производительности и обработка ошибок. В современных приложениях часто используется вместе с Page Visibility API и имеет fallback на fetch с опцией keepalive

sendBeacon в отличие от XMLHTTPRequest гарантирует отправку запроса в слушателе события beforeunload
___
### Базовое использование
```js
navigator.sendBeacon(url, data)
```
___
При использовании метода sendBeacon(), данные будут переданы на сервер асинхронно, как только браузер найдёт оптимальный момент для этого. Это не вызовет задержек выгрузки и не повлияет на время загрузки следующей страницы. Решает все проблемы при отправлении аналитики: данные надёжно доставляются, это происходит асинхронно, не влияет на время выгрузки и загрузки страниц. Кроме того, код выглядит проще, чем при использовании прочих ухищрений.

Не используйте это.
```js
window.addEventListener("unload", logData, false);

function logData() {
  var client = new XMLHttpRequest();
  client.open("POST", "/log", false); // последний параметр устанавливает синхронный стиль
  client.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
  client.send(analyticsData);
}
```
как сделать отправление аналитики красиво и просто
```js
window.addEventListener("unload", logData, false);

function logData() {
  navigator.sendBeacon("/log", analyticsData);
}
```
