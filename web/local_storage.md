# LocalStorage, sessionStorage

---

Объекты веб-хранилища localStorage и sessionStorage позволяют хранить пары ключ/значение в браузере.

sessionStorage - данные, которые в них записаны, сохраняются после обновления страницы

localStorage - данные, которые в них записаны, сохраняются после перезапуска браузера

Но ведь у нас уже есть куки. Зачем тогда эти объекты?

В отличие от куки, объекты веб-хранилища не отправляются на сервер при каждом запросе. Именно поэтому мы можем хранить гораздо больше данных. Большинство современных браузеров могут выделить как минимум 5 мегабайтов данных (или больше), и этот размер можно поменять в настройках.
Ещё одно отличие от куки – сервер не может манипулировать объектами хранилища через HTTP-заголовки. Всё делается при помощи JavaScript.
Хранилище привязано к источнику (домен/протокол/порт). Это значит, что разные протоколы или поддомены определяют разные объекты хранилища, и они не могут получить доступ к данным друг друга.

Объект localStorage доступен всем окнам из одного источника, поэтому, если мы устанавливаем данные в одном окне, изменения становятся видимыми в другом.

### sessionStorage

sessionStorage существует только в рамках текущей вкладки браузера.

- Другая вкладка с той же страницей будет иметь другое хранилище.
- Но оно разделяется между ифреймами на той же вкладке (при условии, что они из одного и того же источника).
  Данные продолжают существовать после перезагрузки страницы, но не после закрытия/открытия вкладки.

## Итого

Объекты веб-хранилища localStorage и sessionStorage позволяют хранить пары ключ/значение в браузере.

- key и value должны быть строками.
- Лимит 5 Мб+, зависит от браузера.
- Данные не имеют «времени истечения».
- Данные привязаны к источнику (домен/протокол/порт).
  |localStorage|sessionStorage|
  |:-|:-|
  |Совместно используется между всеми вкладками и окнами с одинаковым источником|Разделяется в рамках вкладки браузера, среди ифреймов из того же источника|
  |«Переживает» перезапуск браузера|«Переживает» перезагрузку страницы (но не закрытие вкладки)|

**API**:

- setItem(key, value) – сохранить пару ключ/значение.
- getItem(key) – получить данные по ключу key.
- removeItem(key) – удалить значение по ключу key.
- clear() – удалить всё.
- key(index) – получить ключ на заданной позиции.
- length – количество элементов в хранилище.

Используйте Object.keys для получения всех ключей.
Можно обращаться к ключам как к обычным свойствам объекта, в этом случае событиеstorage не срабатывает.

Событие storage:

- Срабатывает при вызове setItem, removeItem, clear.
- Содержит все данные об произошедшем обновлении (key/oldValue/newValue), url документа и объект хранилища storageArea.
- Срабатывает на всех объектах window, которые имеют доступ к хранилищу, кроме того, где оно было сгенерировано (внутри вкладки для sessionStorage, глобально для localStorage).
