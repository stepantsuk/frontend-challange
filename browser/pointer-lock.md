# Pointer Lock API

**Ð¡ÑƒÑ‚ÑŒ API** - API Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÐµÑ‚ ÐºÑƒÑ€ÑÐ¾Ñ€ Ð² Ð¿Ñ€ÐµÐ´ÐµÐ»Ð°Ñ… ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð°, Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑ Ð±ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ð¾Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð¼Ñ‹ÑˆÐ¸ Ð²Ð¼ÐµÑÑ‚Ð¾
Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚. Ð˜Ð´ÐµÐ°Ð»ÑŒÐ½Ð¾ Ð´Ð»Ñ FPS-Ð¸Ð³Ñ€, 3D-Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸ Ð¿Ð°Ð½Ð¾Ñ€Ð°Ð¼Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¾Ð².

**Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ðµ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ**
- First-person ÐºÐ°Ð¼ÐµÑ€Ñ‹ - Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð¼Ñ‹ÑˆÑŒÑŽ
- 3D-Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€Ñ‹ - Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²/ÑÑ†ÐµÐ½Ñ‹
- Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð´Ð»Ñ ÑÐºÑ€Ð¸Ð½ÑˆÐ¾Ñ‚Ð¾Ð² - Ñ‚Ð¾Ñ‡Ð½Ð¾Ðµ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ
- Ð’ÐµÐ±-Ð¸Ð³Ñ€Ñ‹ - ÑˆÑƒÑ‚ÐµÑ€Ñ‹, ÑÐ¸Ð¼ÑƒÐ»ÑÑ‚Ð¾Ñ€Ñ‹
- ÐŸÐ°Ð½Ð¾Ñ€Ð°Ð¼Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ñ‹ - 360Â° Ñ„Ð¾Ñ‚Ð¾/Ð²Ð¸Ð´ÐµÐ¾

**Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ**
- Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ user gesture - Ð·Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð·Ð»Ð¾Ð½Ð°Ð¼ÐµÑ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð·Ð°Ñ…Ð²Ð°Ñ‚Ð°
- Ð‘Ñ€Ð°ÑƒÐ·ÐµÑ€Ð½Ñ‹Ðµ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ - Chrome Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ "Press Esc to exit"
- Ð¢Ð°Ñ‡-ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð° - Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ, Ð½Ð¾ Ñ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚ÑÐ¼Ð¸
- ÐœÑƒÐ»ÑŒÑ‚Ð¸Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ - Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¾ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¾Ð¼

**Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ**
Pointer Lock API Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð½Ð¸Ð·ÐºÐ¾ÑƒÑ€Ð¾Ð²Ð½ÐµÐ²Ñ‹Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¼Ñƒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸ÑŽ Ð¼Ñ‹ÑˆÐ¸, ÑƒÐ±Ð¸Ñ€Ð°Ñ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ ÑÐºÑ€Ð°Ð½Ð°. ÐšÐ»ÑŽÑ‡ÐµÐ²Ð¾Ðµ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð¸Ðµ Ð¾Ñ‚ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… mouse events â€” Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ movementX/Y Ð²Ð¼ÐµÑÑ‚Ð¾ Ð°Ð±ÑÐ¾Ð»ÑŽÑ‚Ð½Ñ‹Ñ… ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚. Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Promise-based Ð²Ñ‹Ð·Ð¾Ð²Ñ‹ Ñ Ð¾Ð¿Ñ†Ð¸ÐµÐ¹ unadjustedMovement Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ raw Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ñ‡Ñ‚Ð¾ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¾ Ð´Ð»Ñ Ð¸Ð³Ñ€ Ð¸ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ñ… 3D-Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð². API Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ ÑÐ²Ð½Ð¾Ð³Ð¾ Ð¶ÐµÑÑ‚Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð²ÑÐµÐ³Ð´Ð° Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑ‚ÑŒ Ð¿Ð¾Ð½ÑÑ‚Ð½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð²Ñ‹Ñ…Ð¾Ð´Ð°.

___

## ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð¸ ÑÐ²Ð¾Ð¹ÑÑ‚Ð²Ð°

1. Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸

```js
   element.requestPointerLock(); // Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Promise Ð² ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°Ñ…
```

2. Ð’Ñ‹Ñ…Ð¾Ð´ Ð¸Ð· Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸

```js
   document.exitPointerLock();
```

3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ

```js
   document.pointerLockElement === element; // null ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
```

___

## ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ

- pointerlockchange - ÑÑ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
- pointerlockerror - Ð¿Ñ€Ð¸ Ð¾ÑˆÐ¸Ð±ÐºÐµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸

```js
document.addEventListener('pointerlockchange', () => {
  if (document.pointerLockElement === myCanvas) {
    // Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ° Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð°
  }
})
```
___
## ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
**ÐžÑ‚Ð»Ð¸Ñ‡Ð¸Ñ Ð¾Ñ‚ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð¼Ñ‹ÑˆÐ¸:**
- movementX/Y Ð²Ð¼ÐµÑÑ‚Ð¾ clientX/Y - Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
- ÐÐµÐ¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ (Ð½Ðµ Ð¿Ñ€Ð¸Ð²ÑÐ·Ð°Ð½Ð¾ Ðº Ð³Ñ€Ð°Ð½Ð¸Ñ†Ð°Ð¼ ÑÐºÑ€Ð°Ð½Ð°)
- ÐšÑƒÑ€ÑÐ¾Ñ€ ÑÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸
___
## Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ñ Promise
```js
// Ð¡Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½
async function enablePointerLock() {
  try {
    await canvas.requestPointerLock({
      unadjustedMovement: true, // ðŸš€ Ð’Ð°Ð¶Ð½Ð°Ñ Ð¾Ð¿Ñ†Ð¸Ñ - Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ Ð°ÐºÑÐµÐ»ÐµÑ€Ð°Ñ†Ð¸ÑŽ Ð¼Ñ‹ÑˆÐ¸
    });
    
    // ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¾Ð² Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
    const moveHandler = (e) => {
      // Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ movementX/movementY
      camera.rotate(e.movementX * sensitivity, e.movementY * sensitivity);
    };
    
    document.addEventListener('mousemove', moveHandler);
    
    // ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð¿Ñ€Ð¸ Ð²Ñ‹Ñ…Ð¾Ð´Ðµ
    document.addEventListener('pointerlockchange', () => {
      if (!document.pointerLockElement) {
        document.removeEventListener('mousemove', moveHandler);
      }
    });
    
  } catch (err) {
    console.error('Pointer lock failed:', err);
  }
}
```


